{"version":3,"file":"chunk-7cffb8b5.js","sources":["../src/utils.ts","../node_modules/kleur/index.js"],"sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\n\nexport function left_pad(str: string, len: number) {\n\twhile (str.length < len) str = ` ${str}`;\n\treturn str;\n}\n\nexport function repeat(str: string, i: number) {\n\tlet result = '';\n\twhile (i--) result += str;\n\treturn result;\n}\n\nexport function format_milliseconds(ms: number) {\n\tif (ms < 1000) return `${ms}ms`;\n\tif (ms < 60000) return `${(ms / 1000).toFixed(1)}s`;\n\n\tconst minutes = ~~(ms / 60000);\n\tconst seconds = Math.round((ms % 60000) / 1000);\n\treturn `${minutes}m${seconds < 10 ? '0' : ''}${seconds}s`;\n}\n\nexport function elapsed(start: number) {\n\treturn format_milliseconds(Date.now() - start);\n}\n\nexport function walk(cwd: string, dir = cwd, files: string[] = []) {\n\tfs.readdirSync(dir).forEach(file => {\n\t\tconst resolved = path.resolve(dir, file);\n\t\tif (fs.statSync(resolved).isDirectory()) {\n\t\t\twalk(cwd, resolved, files);\n\t\t} else {\n\t\t\tfiles.push(posixify(path.relative(cwd, resolved)));\n\t\t}\n\t});\n\n\treturn files;\n}\n\nexport function posixify(str: string) {\n\treturn str.replace(/\\\\/g, '/');\n}\n\nconst previous_contents = new Map();\n\nexport function write_if_changed(file: string, code: string) {\n\tif (code !== previous_contents.get(file)) {\n\t\tprevious_contents.set(file, code);\n\t\tfs.writeFileSync(file, code);\n\t\tfudge_mtime(file);\n\t}\n}\n\nexport function stringify(string: string, includeQuotes: boolean = true) {\n\tconst quoted = JSON.stringify(string);\n\treturn includeQuotes ? quoted : quoted.slice(1, -1);\n}\n\nexport function fudge_mtime(file: string) {\n\t// need to fudge the mtime so that webpack doesn't go doolally\n\tconst { atime, mtime } = fs.statSync(file);\n\tfs.utimesSync(\n\t\tfile,\n\t\tnew Date(atime.getTime() - 999999),\n\t\tnew Date(mtime.getTime() - 999999)\n\t);\n}\n\nexport const reserved_words = new Set([\n\t'arguments',\n\t'await',\n\t'break',\n\t'case',\n\t'catch',\n\t'class',\n\t'const',\n\t'continue',\n\t'debugger',\n\t'default',\n\t'delete',\n\t'do',\n\t'else',\n\t'enum',\n\t'eval',\n\t'export',\n\t'extends',\n\t'false',\n\t'finally',\n\t'for',\n\t'function',\n\t'if',\n\t'implements',\n\t'import',\n\t'in',\n\t'instanceof',\n\t'interface',\n\t'let',\n\t'new',\n\t'null',\n\t'package',\n\t'private',\n\t'protected',\n\t'public',\n\t'return',\n\t'static',\n\t'super',\n\t'switch',\n\t'this',\n\t'throw',\n\t'true',\n\t'try',\n\t'typeof',\n\t'var',\n\t'void',\n\t'while',\n\t'with',\n\t'yield',\n]);","const $ = { enabled:true };\n\nconst CODES = {\n  // modifiers\n  reset: fmt(0, 0),\n  bold: fmt(1, 22),\n  dim: fmt(2, 22),\n  italic: fmt(3, 23),\n  underline: fmt(4, 24),\n  inverse: fmt(7, 27),\n  hidden: fmt(8, 28),\n  strikethrough: fmt(9, 29),\n  // colors\n  black: fmt(30, 39),\n  red: fmt(31, 39),\n  green: fmt(32, 39),\n  yellow: fmt(33, 39),\n  blue: fmt(34, 39),\n  magenta: fmt(35, 39),\n  cyan: fmt(36, 39),\n  white: fmt(37, 39),\n  gray: fmt(90, 39),\n  // background colors\n  bgBlack: fmt(40, 49),\n  bgRed: fmt(41, 49),\n  bgGreen: fmt(42, 49),\n  bgYellow: fmt(43, 49),\n  bgBlue: fmt(44, 49),\n  bgMagenta: fmt(45, 49),\n  bgCyan: fmt(46, 49),\n  bgWhite: fmt(47, 49)\n};\n\nfunction fmt(x, y) {\n\treturn {\n\t\topen: `\\x1b[${x}m`,\n\t\tclose: `\\x1b[${y}m`,\n\t\trgx: new RegExp(`\\\\x1b\\\\[${y}m`, 'g')\n\t}\n}\n\nfunction run(key, str) {\n\tlet tmp = CODES[key];\n\treturn tmp.open + str.replace(tmp.rgx, tmp.open) + tmp.close;\n}\n\nfunction exec(key, str) {\n\tstr += '';\n\tif (!$.enabled) return str;\n\tlet arr = this.keys;\n\twhile (arr.length > 0) {\n\t\tstr = run(arr.shift(), str);\n\t}\n\tthis.keys.push(key);\n\treturn str;\n}\n\nfunction attach(key) {\n\tlet ctx = { keys:[key] };\n\tlet fn = exec.bind(ctx, key);\n\tfor (let k in CODES) {\n\t\tReflect.defineProperty(fn, k, {\n\t\t\tget() {\n\t\t\t\tctx.keys.push(k);\n\t\t\t\treturn fn;\n\t\t\t}\n\t\t});\n\t}\n\treturn fn;\n}\n\nfor (let k in CODES) {\n\t$[k] = attach(k);\n}\n\nmodule.exports = $;\n"],"names":["fs.readdirSync","path.resolve","fs.statSync","path.relative","fs.writeFileSync","fs.utimesSync"],"mappings":";;;;;;;;;SAGgB,QAAQ,CAAC,GAAW,EAAE,GAAW;IAChD,OAAO,GAAG,CAAC,MAAM,GAAG,GAAG;QAAE,GAAG,GAAG,MAAI,GAAK,CAAC;IACzC,OAAO,GAAG,CAAC;CACX;AAED,SAAgB,MAAM,CAAC,GAAW,EAAE,CAAS;IAC5C,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,OAAO,CAAC,EAAE;QAAE,MAAM,IAAI,GAAG,CAAC;IAC1B,OAAO,MAAM,CAAC;CACd;AAED,SAAgB,mBAAmB,CAAC,EAAU;IAC7C,IAAI,EAAE,GAAG,IAAI;QAAE,OAAU,EAAE,OAAI,CAAC;IAChC,IAAI,EAAE,GAAG,KAAK;QAAE,OAAU,CAAC,EAAE,GAAG,IAAI,EAAE,OAAO,CAAC,CAAC,CAAC,MAAG,CAAC;IAEpD,IAAM,OAAO,GAAG,CAAC,EAAE,EAAE,GAAG,KAAK,CAAC,CAAC;IAC/B,IAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE,GAAG,KAAK,IAAI,IAAI,CAAC,CAAC;IAChD,OAAU,OAAO,UAAI,OAAO,GAAG,EAAE,GAAG,GAAG,GAAG,EAAE,IAAG,OAAO,MAAG,CAAC;CAC1D;AAED,SAAgB,OAAO,CAAC,KAAa;IACpC,OAAO,mBAAmB,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC,CAAC;CAC/C;AAED,SAAgB,IAAI,CAAC,GAAW,EAAE,GAAS,EAAE,KAAoB;IAA/B,oBAAA,EAAA,SAAS;IAAE,sBAAA,EAAA,UAAoB;IAChEA,cAAc,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,UAAA,IAAI;QAC/B,IAAM,QAAQ,GAAGC,YAAY,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;QACzC,IAAIC,WAAW,CAAC,QAAQ,CAAC,CAAC,WAAW,EAAE,EAAE;YACxC,IAAI,CAAC,GAAG,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;SAC3B;aAAM;YACN,KAAK,CAAC,IAAI,CAAC,QAAQ,CAACC,aAAa,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;SACnD;KACD,CAAC,CAAC;IAEH,OAAO,KAAK,CAAC;CACb;AAED,SAAgB,QAAQ,CAAC,GAAW;IACnC,OAAO,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;CAC/B;AAED,IAAM,iBAAiB,GAAG,IAAI,GAAG,EAAE,CAAC;AAEpC,SAAgB,gBAAgB,CAAC,IAAY,EAAE,IAAY;IAC1D,IAAI,IAAI,KAAK,iBAAiB,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE;QACzC,iBAAiB,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAClCC,gBAAgB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAC7B,WAAW,CAAC,IAAI,CAAC,CAAC;KAClB;CACD;AAED,SAAgB,SAAS,CAAC,MAAc,EAAE,aAA6B;IAA7B,8BAAA,EAAA,oBAA6B;IACtE,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IACtC,OAAO,aAAa,GAAG,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;CACpD;AAED,SAAgB,WAAW,CAAC,IAAY;;IAEjC,IAAA,sBAAoC,EAAlC,gBAAK,EAAE,gBAA2B,CAAC;IAC3CC,aAAa,CACZ,IAAI,EACJ,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,MAAM,CAAC,EAClC,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,GAAG,MAAM,CAAC,CAClC,CAAC;CACF;AAED,IAAa,cAAc,GAAG,IAAI,GAAG,CAAC;IACrC,WAAW;IACX,OAAO;IACP,OAAO;IACP,MAAM;IACN,OAAO;IACP,OAAO;IACP,OAAO;IACP,UAAU;IACV,UAAU;IACV,SAAS;IACT,QAAQ;IACR,IAAI;IACJ,MAAM;IACN,MAAM;IACN,MAAM;IACN,QAAQ;IACR,SAAS;IACT,OAAO;IACP,SAAS;IACT,KAAK;IACL,UAAU;IACV,IAAI;IACJ,YAAY;IACZ,QAAQ;IACR,IAAI;IACJ,YAAY;IACZ,WAAW;IACX,KAAK;IACL,KAAK;IACL,MAAM;IACN,SAAS;IACT,SAAS;IACT,WAAW;IACX,QAAQ;IACR,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,QAAQ;IACR,MAAM;IACN,OAAO;IACP,MAAM;IACN,KAAK;IACL,QAAQ;IACR,KAAK;IACL,MAAM;IACN,OAAO;IACP,MAAM;IACN,OAAO;CACP,CAAC;;ACtHF,MAAM,CAAC,GAAG,EAAE,OAAO,CAAC,IAAI,EAAE,CAAC;;AAE3B,MAAM,KAAK,GAAG;;EAEZ,KAAK,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;EAChB,IAAI,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;EAChB,GAAG,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;EACf,MAAM,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;EAClB,SAAS,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;EACrB,OAAO,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;EACnB,MAAM,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;EAClB,aAAa,EAAE,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC;;EAEzB,KAAK,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EAClB,GAAG,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EAChB,KAAK,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EAClB,MAAM,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACnB,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACjB,OAAO,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACpB,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACjB,KAAK,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EAClB,IAAI,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;;EAEjB,OAAO,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACpB,KAAK,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EAClB,OAAO,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACpB,QAAQ,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACrB,MAAM,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACnB,SAAS,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACtB,MAAM,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;EACnB,OAAO,EAAE,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC;CACrB,CAAC;;AAEF,SAAS,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE;CAClB,OAAO;EACN,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;EAClB,KAAK,EAAE,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;EACnB,GAAG,EAAE,IAAI,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC;EACrC;CACD;;AAED,SAAS,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE;CACtB,IAAI,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC;CACrB,OAAO,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,KAAK,CAAC;CAC7D;;AAED,SAAS,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE;CACvB,GAAG,IAAI,EAAE,CAAC;CACV,IAAI,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,GAAG,CAAC;CAC3B,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC;CACpB,OAAO,GAAG,CAAC,MAAM,GAAG,CAAC,EAAE;EACtB,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC,KAAK,EAAE,EAAE,GAAG,CAAC,CAAC;EAC5B;CACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;CACpB,OAAO,GAAG,CAAC;CACX;;AAED,SAAS,MAAM,CAAC,GAAG,EAAE;CACpB,IAAI,GAAG,GAAG,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,CAAC;CACzB,IAAI,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;CAC7B,KAAK,IAAI,CAAC,IAAI,KAAK,EAAE;EACpB,OAAO,CAAC,cAAc,CAAC,EAAE,EAAE,CAAC,EAAE;GAC7B,GAAG,GAAG;IACL,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IACjB,OAAO,EAAE,CAAC;IACV;GACD,CAAC,CAAC;EACH;CACD,OAAO,EAAE,CAAC;CACV;;AAED,KAAK,IAAI,CAAC,IAAI,KAAK,EAAE;CACpB,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;CACjB;;AAED,SAAc,GAAG,CAAC,CAAC;;;;;;;;;;;;;"}